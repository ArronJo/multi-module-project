package com.snc.test.filemanager.file2

import com.snc.zero.filemanager.file2.FSFile
import com.snc.zero.filemanager.file2.extensions.toFile
import com.snc.zero.logger.jvm.TLogging
import com.snc.zero.test.base.BaseJUnit5Test
import org.junit.jupiter.api.BeforeEach
import org.junit.jupiter.api.Test
import org.junit.jupiter.api.TestInfo
import java.io.File
import java.nio.file.Paths

private val logger = TLogging.logger { }

class FSFileWriteTest : BaseJUnit5Test() {

    private lateinit var parent: File
    private lateinit var dir: File

    @BeforeEach
    override fun beforeEach(testInfo: TestInfo) {
        super.beforeEach(testInfo)

        val projectRoot = Paths.get("").toAbsolutePath()
        println("Project Root Directory: $projectRoot")
        parent = "${projectRoot}/build/zzz".toFile()
        dir = "$parent/ttt".toFile()
    }

    @Test
    fun `FSFile write`() {
        val file = File(dir, "android.svg")
        val data =
            """
<?xml version="1.0" encoding="UTF-8"?>
<svg width="70px" height="70px" viewBox="0 0 70 70" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com -->
    <title>btn_download_google</title>
    <desc>Created with Sketch.</desc>
    <defs>
        <polygon id="path-1" points="4.84375e-05 0.0913414634 7.41425547 0.0913414634 7.41425547 7.75384146 4.84375e-05 7.75384146"></polygon>
        <polygon id="path-3" points="0 9.90871951 30.8996133 9.90871951 30.8996133 0.122012195 0 0.122012195"></polygon>
    </defs>
    <g id="여행상품-템플릿" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <g id="LT_여행상품_iOS375" transform="translate(-280.000000, -5468.000000)">
            <g id="footer" transform="translate(0.000000, 5170.000000)" fill="#F6F6F6">
                <rect id="bg" x="2.84217094e-14" y="0" width="375" height="583"></rect>
            </g>
            <g id="btn_download_google" transform="translate(280.000000, 5468.000000)">
                <g id="logo_google" transform="translate(10.000000, 51.000000)">
                    <g id="Group-13">
                        <g id="Group-3" transform="translate(0.000000, 0.030671)">
                            <mask id="mask-2" fill="white">
                                <use xlink:href="#path-1"></use>
                            </mask>
                            <g id="Clip-2"></g>
                            <path d="M3.85930625,3.5777439 L3.85930625,4.62493902 L6.34475547,4.62493902 C6.26870859,5.21237805 6.07423203,5.64237805 5.7784,5.94457317 C5.41487656,6.31067073 4.8484,6.71079268 3.85930625,6.71079268 C2.32904453,6.71079268 1.13288047,5.46786585 1.13288047,3.92676829 C1.13288047,2.38579268 2.32904453,1.1427439 3.85930625,1.1427439 C4.68359141,1.1427439 5.28797031,1.47054878 5.7319,1.8920122 L6.46306406,1.15554878 C5.84597031,0.551036585 5.01744688,0.0912804878 3.85930625,0.0912804878 C1.76268906,0.0912804878 4.84375e-05,1.81115854 4.84375e-05,3.92262195 C4.84375e-05,6.03408537 1.76268906,7.75384146 3.85930625,7.75384146 C4.99213828,7.75384146 5.84597031,7.37920732 6.51380234,6.68103659 C7.19870859,5.99140244 7.41425547,5.01664634 7.41425547,4.23323171 C7.41425547,3.99067073 7.39730234,3.76506098 7.35927891,3.5777439 L3.85930625,3.5777439 Z" id="Fill-1" fill="#B4B4B4" mask="url(#mask-2)"></path>
                        </g>
                        <path d="M10.5211094,6.72876829 C9.77710937,6.72876829 9.13458594,6.11145122 9.13458594,5.23035366 C9.13458594,4.34059756 9.77710937,3.73181707 10.5211094,3.73181707 C11.2651094,3.73181707 11.9075117,4.34059756 11.9075117,5.23035366 C11.9075117,6.11145122 11.2651094,6.72876829 10.5211094,6.72876829 M10.5211094,2.75706098 C9.16413281,2.75706098 8.05673047,3.79571951 8.05673047,5.23035366 C8.05673047,6.65218293 9.16413281,7.70364634 10.5211094,7.70364634 C11.8779648,7.70364634 12.9854883,6.65632927 12.9854883,5.23035366 C12.9854883,3.79571951 11.8779648,2.75706098 10.5211094,2.75706098" id="Fill-4" fill="#B4B4B4"></path>
                        <path d="M21.3633836,6.72876829 C20.6193836,6.72876829 20.0531492,6.09023171 20.0531492,5.23035366 C20.0531492,4.35767073 20.6193836,3.73181707 21.3633836,3.73181707 C22.098907,3.73181707 22.6737622,4.37047561 22.6737622,5.23876829 C22.6779773,6.10291463 22.098907,6.72876829 21.3633836,6.72876829 L21.3633836,6.72876829 Z M22.6020516,3.31047561 L22.563907,3.31047561 C22.3230516,3.02096341 21.8580516,2.75706098 21.2703836,2.75706098 C20.0445516,2.75706098 18.9751727,3.8340122 18.9751727,5.23035366 C18.9751727,6.61815854 20.0445516,7.70364634 21.2703836,7.70364634 C21.8580516,7.70364634 22.3230516,7.43962195 22.563907,7.14169512 L22.6020516,7.14169512 L22.6020516,7.48657317 C22.6020516,8.43157317 22.098907,8.93815854 21.291575,8.93815854 C20.6322195,8.93815854 20.222075,8.46132927 20.0531492,8.05693902 L19.1146727,8.44864634 C19.3851961,9.1042561 20.0995281,9.90864634 21.291575,9.90864634 C22.5555516,9.90864634 23.6249305,9.1595 23.6249305,7.33328049 L23.6249305,2.8847439 L22.6020516,2.8847439 L22.6020516,3.31047561 Z" id="Fill-6" fill="#B4B4B4"></path>
                        <path d="M16.0162105,6.72876829 C15.2722105,6.72876829 14.6298082,6.11145122 14.6298082,5.23035366 C14.6298082,4.34059756 15.2722105,3.73181707 16.0162105,3.73181707 C16.7602105,3.73181707 17.402734,4.34059756 17.402734,5.23035366 C17.402734,6.11145122 16.7602105,6.72876829 16.0162105,6.72876829 M16.0162105,2.75706098 C14.6593551,2.75706098 13.5518316,3.79571951 13.5518316,5.23035366 C13.5518316,6.65218293 14.6593551,7.70364634 16.0162105,7.70364634 C17.373066,7.70364634 18.4805895,6.65632927 18.4805895,5.23035366 C18.4805895,3.79571951 17.373066,2.75706098 16.0162105,2.75706098" id="Fill-8" fill="#B4B4B4"></path>
                        <mask id="mask-4" fill="white">
                            <use xlink:href="#path-3"></use>
                        </mask>
                        <g id="Clip-11"></g>
                        <polygon id="Fill-10" fill="#B4B4B4" mask="url(#mask-4)" points="24.4702617 7.70359756 25.5312852 7.70359756 25.5312852 0.224085366 24.4702617 0.224085366"></polygon>
                        <path d="M28.7311754,3.68504878 C29.1666285,3.68504878 29.5385074,3.91065854 29.6611754,4.22992683 L27.4420113,5.15358537 C27.4420113,4.11492683 28.1732965,3.68504878 28.7311754,3.68504878 M28.8072223,6.72870732 C28.2576988,6.72870732 27.8688668,6.47760976 27.6151754,5.97956098 L30.8996012,4.61309756 L30.7897691,4.33212195 C30.586816,3.77870732 29.9612457,2.757 28.6887926,2.757 C27.4250582,2.757 26.3723902,3.75736585 26.3723902,5.23029268 C26.3723902,6.61809756 27.4122223,7.70370732 28.8072223,7.70370732 C29.9315777,7.70370732 30.5825777,7.00968293 30.8531012,6.60956098 L30.0161012,6.04773171 C29.7372223,6.45626829 29.3567457,6.72870732 28.8072223,6.72870732" id="Fill-12" fill="#B4B4B4" mask="url(#mask-4)"></path>
                    </g>
                </g>
                <path d="M25,38.1530078 L25,14.8497064 C25,14.0365171 25.450978,13.3335936 26.1054244,13 L39,26.4973818 L26.1002385,40 C25.4485945,39.665392 25,38.9640997 25,38.1530078 Z M43,30.2153759 L29,39 L40.0414623,27 L43,30.2153759 Z M48.1211398,24.8355725 C48.6553782,25.2190502 49,25.8232969 49,26.502952 C49,27.1723941 48.6658213,27.7685263 48.1453081,28.1527036 L44.7335521,30 L41,26.4988948 L44.731016,23 L48.1211398,24.8355725 Z M29,14 L43,22.7846427 L40.0414718,26 L29,14 Z" id="logo" fill="#B4B4B4" fill-rule="nonzero"></path>
                <path d="M46.7109375,56.1708984 C46.7109375,56.9062537 46.543947,57.4929177 46.2099609,57.9309082 C45.8759749,58.3688987 45.4277372,58.5878906 44.8652344,58.5878906 C44.3437474,58.5878906 43.9262711,58.4165056 43.612793,58.0737305 L43.612793,60.328125 L42.5449219,60.328125 L42.5449219,53.7451172 L43.5292969,53.7451172 L43.5732422,54.2285156 C43.8867203,53.8476543 44.3129856,53.6572266 44.8520508,53.6572266 C45.4321318,53.6572266 45.8869612,53.8732889 46.2165527,54.3054199 C46.5461442,54.737551 46.7109375,55.3373985 46.7109375,56.1049805 L46.7109375,56.1708984 Z M45.6474609,56.0786133 C45.6474609,55.6040015 45.5529795,55.2275405 45.3640137,54.9492188 C45.1750479,54.670897 44.9047869,54.5317383 44.5532227,54.5317383 C44.116697,54.5317383 43.8032236,54.7119123 43.612793,55.0722656 L43.612793,57.1816406 C43.8061533,57.5507831 44.1225564,57.7353516 44.5620117,57.7353516 C44.9018572,57.7353516 45.1677236,57.59839 45.3596191,57.3244629 C45.5515146,57.0505357 45.6474609,56.6352567 45.6474609,56.0786133 Z M48.75,58.5 L47.6821289,58.5 L47.6821289,51.75 L48.75,51.75 L48.75,58.5 Z M52.753418,58.5 C52.7065427,58.4091792 52.6655275,58.2612315 52.6303711,58.0561523 C52.2905256,58.4106463 51.8745142,58.5878906 51.3823242,58.5878906 C50.9047828,58.5878906 50.5151382,58.4516615 50.2133789,58.1791992 C49.9116196,57.9067369 49.7607422,57.5698262 49.7607422,57.168457 C49.7607422,56.6616186 49.9489727,56.2727064 50.3254395,56.001709 C50.7019062,55.7307115 51.2402309,55.5952148 51.9404297,55.5952148 L52.5952148,55.5952148 L52.5952148,55.2832031 C52.5952148,55.0371081 52.5263679,54.8400886 52.3886719,54.6921387 C52.2509759,54.5441887 52.0415053,54.4702148 51.7602539,54.4702148 C51.5170886,54.4702148 51.3178719,54.5310053 51.1625977,54.6525879 C51.0073234,54.7741705 50.9296875,54.92871 50.9296875,55.1162109 L49.8618164,55.1162109 C49.8618164,54.8554674 49.9482413,54.6115734 50.1210938,54.3845215 C50.2939462,54.1574696 50.5290512,53.9794928 50.826416,53.8505859 C51.1237808,53.721679 51.4555646,53.6572266 51.8217773,53.6572266 C52.3784208,53.6572266 52.822264,53.7971177 53.1533203,54.0769043 C53.4843767,54.3566909 53.6542968,54.7499975 53.6630859,55.2568359 L53.6630859,57.4013672 C53.6630859,57.8291037 53.7231439,58.1704089 53.8432617,58.425293 L53.8432617,58.5 L52.753418,58.5 Z M51.5800781,57.730957 C51.7910167,57.730957 51.989501,57.679688 52.1755371,57.5771484 C52.3615732,57.4746089 52.5014644,57.3369149 52.5952148,57.1640625 L52.5952148,56.2675781 L52.0195312,56.2675781 C51.6240215,56.2675781 51.3266612,56.3364251 51.1274414,56.4741211 C50.9282217,56.6118171 50.8286133,56.8066394 50.8286133,57.0585938 C50.8286133,57.2636729 50.8967278,57.4270013 51.032959,57.548584 C51.1691901,57.6701666 51.3515614,57.730957 51.5800781,57.730957 Z M56.4448242,56.9707031 L57.4116211,53.7451172 L58.5498047,53.7451172 L56.6601562,59.2207031 C56.3701157,60.0205118 55.8779332,60.4204102 55.1835938,60.4204102 C55.0283195,60.4204102 54.8569345,60.3940432 54.6694336,60.3413086 L54.6694336,59.5151367 L54.871582,59.5283203 C55.1411146,59.5283203 55.3439935,59.4792485 55.4802246,59.3811035 C55.6164558,59.2829585 55.7241207,59.1181652 55.8032227,58.8867188 L55.9570312,58.4780273 L54.2871094,53.7451172 L55.4384766,53.7451172 L56.4448242,56.9707031 Z" id="play" fill="#B4B4B4" fill-rule="nonzero"></path>
            </g>
        </g>
    </g>
</svg>
            """.trimIndent()

        assertDoesNotThrow {
            FSFile.write(data.toByteArray(), file, overwrite = true)
        }
        if (!file.exists()) {
            logger.debug { "$file not exist" }
        }
    }

    @Test
    fun `FSFile copy`() {
        val src = File(dir, "write_test.js")
        val dst = File(dir, "copy_test.js")
        assertDoesNotThrow {
            FSFile.copy(src, dst, overwrite = true)
        }
        if (!dst.exists()) {
            logger.debug { "$dst not exist" }
        }
    }
}